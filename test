        function updateMap() {{
            var selectedLayer = document.getElementById('layer-select').value;
            if (selectedLayer === 'avg_6_months') {{
                map.removeLayer(layer_60);
                map.addLayer(layer_6);
                updateLegend(colormap_6, [0,30,60,90,120,150]);
            }} else {{
                map.removeLayer(layer_6);
                map.addLayer(layer_60);
                updateLegend(colormap_60, [0,30,60,90,120,150]);
            }}
        }}

        function updateLegend(colormap, domain) {{
            var legend = d3.select('#legend');
            legend.html('<h4>EUR Value</h4>');
            var legendScale = d3.scaleLinear()
                .domain([domain[0], domain[domain.length - 1]])
                .range([0, 300]);
            var legendAxis = d3.axisBottom(legendScale)
                .ticks(5)
                .tickFormat(d3.format(".2f"));

            var svg = legend.append('svg')
                .attr('width', 320)
                .attr('height', 50);

            svg.append('g')
                .attr('class', 'axis')
                .attr('transform', 'translate(10,30)')
                .call(legendAxis);

            var gradient = svg.append('defs')
                .append('linearGradient')
                .attr('id', 'gradient')
                .attr('x1', '0%')
                .attr('y1', '0%')
                .attr('x2', '100%')
                .attr('y2', '0%');

            domain.forEach(function(d, i) {{
                gradient.append('stop')
                    .attr('offset', (i / (domain.length - 1) * 100) + '%')
                    .attr('stop-color', colormap(d));
            }});

            svg.append('rect')
                .attr('width', 300)
                .attr('height', 10)
                .attr('x', 10)
                .attr('y', 20)
                .style('fill', 'url(#gradient)');
        }}

        updateLegend(colormap_6, [0,30,60,90,120,150]);
    </script>
</body>
</html>
"""
